FROM postgres:17

RUN apt-get update && \
    apt-get install -y pgagent postgresql-client && \
    rm -rf /var/lib/apt/lists/*

CMD ["bash", "-c", "\
echo 'Waiting for PostgreSQL...'; \
until pg_isready -h postgres -U postgres; do sleep 2; done; \
echo 'PostgreSQL ready â€” starting pgAgent'; \
pgagent host=postgres dbname=mydatabase user=postgres \
"]
